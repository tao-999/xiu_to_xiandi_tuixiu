import 'dart:math';
import 'dart:ui';
import 'package:flame/components.dart';

import '../../../utils/name_generator.dart';
import '../dynamic_sprite_entry.dart';
import '../floating_island_dynamic_spawner_component.dart';
import '../floating_island_static_spawner_component.dart';
import '../noise_tile_map_generator.dart';
import '../static_sprite_entry.dart';

class BeachDecorator extends Component {
  final Component grid;
  final Vector2 Function() getLogicalOffset;
  final Vector2 Function() getViewSize;
  final NoiseTileMapGenerator noiseMapGenerator;
  final int seed;

  BeachDecorator({
    required this.grid,
    required this.getLogicalOffset,
    required this.getViewSize,
    required this.noiseMapGenerator,
    required this.seed,
  });

  @override
  Future<void> onLoad() async {
    final List<String> taunts = [
      "æ»šå¼€ï¼",
      "ä½ ç®—å“ªæ ¹è‘±ï¼Ÿ",
      "åˆ«æ¥ç¢çœ¼ï¼",
      "æ‰¾æŠ½æ˜¯ä¸æ˜¯ï¼Ÿ",
      "ä½ æœ‰ç—…å•Šï¼Ÿ",
      "ç¦»è¿œç‚¹ï¼",
      "å†ç¢°è¯•è¯•ï¼",
      "ä¸çŸ¥æ­»æ´»ï¼",
      "åºŸç‰©ï¼",
      "çœŸçƒ¦äººï¼",
      "åˆ«ç¢°æˆ‘ï¼",
      "æƒ³æ­»å•Šï¼Ÿ",
      "è ¢è´§ï¼",
      "æ²¡é•¿çœ¼ï¼Ÿ",
      "çœŸè®¨åŒï¼",
      "èµ°å¼€ï¼",
      "ä¸é…å’Œæˆ‘æ¯”ï¼",
      "è‡ªå–å…¶è¾±ï¼",
      "åˆæ¥ï¼Ÿ",
      "æ­»è¿œç‚¹ï¼",
      "å•§ï¼Œä¸¢äººï¼",
      "è¿˜æ•¢è¿‡æ¥ï¼Ÿ",
      "å¥½èƒ†å†æ¥ï¼",
      "æ²¡å®Œæ²¡äº†ï¼",
      "å†é è¿‘è¯•è¯•ï¼",
      "å°‘åºŸè¯ï¼",
      "ä¸€è¾¹å»ï¼",
      "ä¸è‡ªé‡åŠ›ï¼",
      "åˆ«çƒ¦æˆ‘ï¼",
      "ä½ ä¹Ÿé…ï¼Ÿ",
      "æˆ‘çœ‹ä½ æ˜¯æ¬ æ”¶æ‹¾ï¼",
      "å°±è¿™ï¼Ÿ",
      "çœ‹æ¸…æ¥šæ˜¯è°ï¼",
      "å†åš£å¼ è¯•è¯•ï¼",
      "æ²¡ç‚¹æœ¬äº‹è¿˜åš·åš·ï¼Ÿ",
      "æ»šè›‹ï¼",
      "ä½ æ‰¾é”™äººäº†ï¼",
      "æƒ³æ¸…æ¥šåæœï¼",
      "è‡ªå–ç­äº¡ï¼",
      "å°å¿ƒæˆ‘æ‰“çˆ†ä½ ï¼",
      "ä½ æ˜¯è‹äº†å—ï¼Ÿ",
      "è°ç»™ä½ çš„å‹‡æ°”ï¼Ÿ",
      "æ€‚è´§ï¼",
      "ç™½ç—´ï¼",
      "ä¸‹ä¸€ä¸ªï¼",
      "è¿˜æƒ³æ¥ï¼Ÿ",
      "çœŸæ²¡åŠ²ï¼",
      "å¯ç¬‘ï¼",
      "æ„šè ¢è‡³æï¼",
      "è¿˜ä¸æ­»å¿ƒï¼Ÿ",
      "ä½ ç´¯ä¸ç´¯ï¼Ÿ",
      "ç¬‘æ­»äººï¼",
      "å°ä¸‘ç½¢äº†ï¼",
      "ç»™ä½ è„¸äº†ï¼Ÿ",
      "åºŸè¯çœŸå¤šï¼",
      "åˆ«è¹­å­˜åœ¨æ„Ÿï¼",
      "å†åŠ¨è¯•è¯•ï¼",
      "å‘¸ï¼Œæ»šå¼€ï¼",
      "ä½ çå•Šï¼Ÿ",
      "æœ‰æœ¬äº‹æ”¾é©¬è¿‡æ¥ï¼",
      "å°±ä½ ï¼Ÿä¹Ÿé…ï¼Ÿ",
      "å›å»ç»ƒå‡ å¹´å†æ¥ï¼",
      "è¯†ç›¸çš„å¿«æ»šï¼",
      "ä¸æ€•æ­»å°±ä¸Šï¼",
      "æˆ‘ç­‰ä½ åŠ¨æ‰‹ï¼",
      "æ¥å•Šï¼Œåˆ«æ€‚ï¼",
      "ä½ ä»¥ä¸ºä½ æ˜¯è°ï¼Ÿ",
      "ä½ å¤ªå¼±äº†ï¼",
      "åˆ«æŒ¡è·¯ï¼",
      "åºŸè¯å°‘è¯´ï¼Œå¼€æ‰“ï¼",
      "å†çªæˆ‘è¯•è¯•ï¼",
      "æ•¢ç¢°æˆ‘ï¼Ÿ",
      "å°±è¿™ç‚¹å®åŠ›ï¼Ÿ",
      "æˆ‘ä¸€æ ¹æ‰‹æŒ‡å¤´ææ­»ä½ ï¼",
      "ä¸æœæ¥æˆ˜ï¼",
      "åˆ«åœ¨æˆ‘é¢å‰ä¸¢äººç°çœ¼ï¼",
      "çœ‹æˆ‘ä¸å‰Šæ­»ä½ ï¼",
      "ç»™æˆ‘çˆ¬ï¼",
      "å¿«æ»šï¼Œå…å¾—ä¸¢å‘½ï¼",
      "å•§ï¼ŒçœŸä¸‘é™‹ï¼",
      "å°å¿ƒæˆ‘ä¸€å·´æŒæ‹æ‰ä½ ï¼",
      "æ²¡ç‚¹åˆ†é‡åˆ«æ¥æ‰¾æŠ½ï¼",
      "æ»šè¿œç‚¹ï¼Œåˆ«è„äº†æˆ‘çš„çœ¼ï¼",
      "è¿˜æ•¢å˜šç‘Ÿï¼Ÿ",
      "è®©ä½ ä¸‰æ‹›éƒ½èµ¢ä¸äº†ï¼",
      "ç»™è„¸ä¸è¦è„¸ï¼",
      "ä½ ç®—ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Ÿ",
      "æ¥å•Šï¼Œäº’ç›¸ä¼¤å®³å•Šï¼",
      "å†è£…é€¼è¯•è¯•ï¼",
      "æ‰¾è™å—ï¼Ÿ",
      "ä¸è‡ªé‡åŠ›çš„ä¸œè¥¿ï¼",
      "èƒ†å­æŒºè‚¥å•Šï¼",
      "æˆ‘çœ‹ä½ æ´»è…»äº†ï¼",
      "æœ‰å¤šè¿œæ»šå¤šè¿œï¼",
      "åºŸç‰©ä¸€ä¸ªï¼",
      "åˆ«å½“å°ä¸‘ï¼",
      "åˆ«åœ¨è¿™å«å”¤ï¼",
      "ä¸€ç¢°å°±ç¢ï¼Œå‘µï¼",
      "è°æƒ¯ç€ä½ äº†ï¼Ÿ",
      "ä½ èƒ½è€ä¹Ÿå°±è¿™æ ·ï¼Ÿ",
      "æœ‰ç§åˆ«è·‘å•Šï¼",
      "è¯´å®Œäº†ï¼Ÿè½®åˆ°æˆ‘äº†ï¼",
      "æ»šå¼€ï¼Œåˆ«ç¢äº‹ï¼",
      "ä½ é…å’Œæˆ‘è¯´è¯ï¼Ÿ",
      "ç¬‘æ­»ï¼Œè ¢åˆ°å®¶äº†ï¼",
      "ä½ è¿™ç‚¹å®åŠ›æ‹¿å‡ºæ¥ä¸¢äººï¼Ÿ",
      "è°ç»™ä½ çš„å‹‡æ°”ï¼Ÿæ¢é™èŒ¹ï¼Ÿ",
      "æ¥å•Šï¼Œçœ‹è°å…ˆæ€‚ï¼",
      "è§ä¸€æ¬¡æ‰“ä¸€æ¬¡ï¼",
      "å°±ä½ ï¼Ÿä¸å¤Ÿçœ‹ï¼",
      "æ´»è¯¥è¢«è™ï¼",
      "æœ‰ç§å°±åˆ«å“­ï¼",
      "æ€•äº†å°±æ»šï¼",
      "æ²¡èµ„æ ¼ç«™åœ¨è¿™ï¼",
      "å¿«å»ç»ƒå‡ å¹´å†æ¥ï¼",
      "ä¸æƒ³æ­»å°±æ»šï¼",
      "å½“æˆ‘æ˜¯æ‘†è®¾ï¼Ÿ",
      "æˆ‘æ‰‹ç—’äº†ï¼",
      "å°‘è·Ÿæˆ‘åºŸè¯ï¼",
      "å˜´ç¡¬æœ‰ç”¨ï¼Ÿ",
      "ä½ æ˜¯æ¥æç¬‘çš„ï¼Ÿ",
      "åŠ¨åŠ¨è„‘å­å†æ¥ï¼",
      "è¦ä¸è¦å…ˆæ‰¾ç‚¹å¸®æ‰‹ï¼Ÿ",
      "çœ‹å¥½äº†ï¼Œè¿™å°±å«å®åŠ›ï¼",
      "è¿ä¸ªæ‹›å‘¼éƒ½æ¥ä¸ä½ï¼",
      "ä½ æ€ä¹ˆè¿˜æ´»ç€ï¼Ÿ",
      "æ‡’å¾—ç†ä½ ï¼",
      "æƒ³æ¸…æ¥šåæœï¼",
      "åˆ«æŠŠè‡ªå·±å½“å›äº‹ï¼",
      "ä¸‰ç§’é’Ÿè§£å†³ä½ ï¼",
      "ç«™è¿™ç¢çœ¼ï¼",
      "æœ¬äº‹å‘¢ï¼Ÿéœ²ä¸€ä¸ªçœ‹çœ‹ï¼",
      "ä¸€è¾¹å‡‰å¿«å»ï¼",
      "ç§ä¸èµ·ä½ ï¼",
      "çœŸæ˜¯ç™½è´¹å£èˆŒï¼",
      "æ­»æ€§ä¸æ”¹å•Šï¼Ÿ",
      "åˆæ¥é€äººå¤´ï¼Ÿ",
      "èµ¶ç´§æ»šè›‹ï¼",
      "å°±è¿™ç‚¹èƒ†å­ï¼Ÿ",
      "å¯æ€œè™«ä¸€ä¸ªï¼",
      "åºŸæï¼",
      "é—­å˜´ï¼",
      "ç¬‘æ‰å¤§ç‰™ï¼",
      "å°å°è¼èšï¼",
      "æ»šè¿œç‚¹ï¼Œåˆ«ä¸¢äººï¼",
      "ä½ æœ‰è„¸è¯´è¯ï¼Ÿ",
      "è¿™æ™ºå•†ï¼Œå ªå¿§ï¼",
      "ä¸¢äººç°çœ¼çš„ä¸œè¥¿ï¼",
    ];

    add(
      FloatingIslandStaticSpawnerComponent(
        grid: grid,
        getLogicalOffset: getLogicalOffset,
        getViewSize: getViewSize,
        getTerrainType: (pos) => noiseMapGenerator.getTerrainTypeAtPosition(pos),
        allowedTerrains: {'beach'},
        staticSpritesMap: {
          'beach': [
            StaticSpriteEntry('floating_island/beach_1.png', 1),
          ],
        },
        staticTileSize: 100.0,
        seed: seed,
        minCount: 10,
        maxCount: 20,
        minSize: 16.0,
        maxSize: 48.0,
      ),
    );

    add(
      FloatingIslandDynamicSpawnerComponent(
        grid: grid,
        getLogicalOffset: getLogicalOffset,
        getViewSize: getViewSize,
        getTerrainType: (pos) => noiseMapGenerator.getTerrainTypeAtPosition(pos),
        noiseMapGenerator: noiseMapGenerator,
        allowedTerrains: {'beach'},
        dynamicSpritesMap: {
          'beach': [
            DynamicSpriteEntry(
              'floating_island/npc_1.png',
              1,
              generateRandomLabel: true, // ğŸŒŸéšæœºç”Ÿæˆåå­—
              labelFontSize: 10,
              labelColor: const Color(0xFF000000),
              minDistance: 500.0,
              maxDistance: 5000.0,
              collisionTexts: taunts,
              desiredWidth: 32,
            ),
          ],
        },
        dynamicTileSize: 256.0,
        seed: seed,
        minDynamicObjectsPerTile: 3,
        maxDynamicObjectsPerTile: 5,
        minSpeed: 15.0,
        maxSpeed: 55.0,
      ),
    );
  }
}
